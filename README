

WHAT IS GUB
***********

Grand Unified Builder (GUB) is the mini packaging system that we
developed for building LilyPond binaries.  It cross-compiles several
packages and assembles them into a single package.  At the moment it
supports the following target platforms

darwin-ppc
   tar.bz2 file for Darwin 7 (MacOS 10.3)/PowerPC

darwin-x86
   tar.bz2 file for Darwin 8 (MacOS 10.4)/x86

mingw
   mingw executable for Windows32

linux
   shar archive for Linux/x86

freebsd
   shar archive for FreeBSD/x86

arm
   shar archive for Linux/ARM (largely untested)

debian
   .deb package for Debian (Linux/x86) (largely untested)

cygwin
   .tar.bz2 packages for Cygwin/Windows32 (largely untested)


ACQUIRING
*********

The Darcs (www.darcs.net) repository is at 

  http://lilypond.org/~hanwen/gub/

You can get the GUB builder by doing

  darcs get http://lilypond.org/~hanwen/gub/


INSTALLING
**********

0. You need 

  - about 7 GB of free space

  - A standard unix development environment with GCC and G++

  - Python 2.4

1. Edit local.make to set some variables.  Here is what my local.make
   contains

  LILYPOND_CVSDIR=downloads/lilypond-$(LILYPOND_BRANCH)/
  LILYPOND_BRANCH=HEAD
  BUILD_PLATFORM=linux
  GUB_DISTCC_ALLOW_HOSTS='192.168.123.191 192.168.123.162 127.0.0.1 192.168.123.107'

2. Prepare build environment

  make bootstrap

3. Build the installers

  make all

this should leave packages in

  uploads/PLATFORM/
  uploads/PLATFORM-cross/

and an installer in

  uploads/lilypond-VERSION-RELEASE.PLATFORM.FORMAT



DISTCC SUPPORT
**************

Run

  make distccd

on a compile server, and

  make <targets> GUB_NATIVE_DISTCC_HOSTS='<hostnames>' \
  	GUB_CROSS_DISTCC_HOSTS='<hostnames>'

GUB_NATIVE_DISTCC_HOSTS should only be used for machines that run the
same platform.

 


USAGE
*****

run the following without arguments for instructions.

  gup-manager.py - package manager 
  gub-builder.py - build packages
  lilypondorg.py - inspect lilypond.org download area
  test-gub.py    - build tester; integrates with Darcs 


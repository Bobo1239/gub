--- denemo-0.8.6/src/main.c~	2009-07-01 16:17:15.000000000 +0200
+++ denemo-0.8.6/src/main.c	2009-07-02 23:12:33.340799850 +0200
@@ -427,11 +427,20 @@ main (int argc, char *argv[])
   /* initialization of directory relocatability */
   initdir();
 #ifdef G_OS_WIN32
-  gchar *scmcode = g_build_filename(get_data_dir(), "share", "guile", NULL);
+  gchar *prefix = g_win32_get_package_installation_directory (NULL, NULL);
+  gchar *scmcode = g_build_filename(prefix, "share", "guile", NULL);
   if(g_file_test(scmcode, G_FILE_TEST_EXISTS)) {
   g_setenv("GUILE_LOAD_PATH", scmcode, TRUE);
   g_print("Set environment variable GUILE_LOAD_PATH to %s\n", scmcode);
   } else warningdialog("You may need to set GUILE_LOAD_PATH to the directory where you have ice9 installed\n");
+  g_setenv("PANGO_PREFIX", prefix, TRUE);
+  g_setenv("PANGO_MODULE_VERSION", "1.6.0", TRUE);
+  g_setenv("PANGO_SO_EXTENSION", ".dll", TRUE);
+  g_print("Set environment variable PANGO_PREFIX to %s\n", prefix);
+  g_setenv("GTK_PREFIX", prefix, TRUE);
+  g_print("Set environment variable GTK_PREFIX to %s\n", prefix);
+  g_setenv("GTK_MODULE_VERSION", "2.10.0", TRUE);
+  g_setenv("GTK_SO_EXTENSION", ".dll", TRUE);
 #endif
   /* locale initialization */
   //setlocale (LC_CTYPE, "");

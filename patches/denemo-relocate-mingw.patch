--- denemo-0.8.6/src/main.c~	2009-07-01 16:17:15.000000000 +0200
+++ denemo-0.8.6/src/main.c	2009-07-03 08:54:26.125846002 +0200
@@ -427,11 +427,25 @@ main (int argc, char *argv[])
   /* initialization of directory relocatability */
   initdir();
 #ifdef G_OS_WIN32
-  gchar *scmcode = g_build_filename(get_data_dir(), "share", "guile", NULL);
-  if(g_file_test(scmcode, G_FILE_TEST_EXISTS)) {
-  g_setenv("GUILE_LOAD_PATH", scmcode, TRUE);
-  g_print("Set environment variable GUILE_LOAD_PATH to %s\n", scmcode);
-  } else warningdialog("You may need to set GUILE_LOAD_PATH to the directory where you have ice9 installed\n");
+  gchar *prefix = g_win32_get_package_installation_directory (NULL, NULL);
+  gchar *guile = g_build_filename (prefix, "share", "guile", NULL);
+  gchar *guile_1_8 = g_build_filename (guile, "1.8", NULL);
+  if (g_file_test (guile, G_FILE_TEST_EXISTS))
+    {
+      gchar *guile_path = g_strconcat (guile, ";", guile_1_8, NULL);
+      g_setenv ("GUILE_LOAD_PATH", guile_path, TRUE);
+      g_print ("Setting GUILE_LOAD_PATH=%s\n", guile_path);
+    }
+  else
+    warningdialog ("You may need to set GUILE_LOAD_PATH to the directory where you have ice9 installed\n");
+  g_setenv ("PANGO_PREFIX", prefix, TRUE);
+  g_setenv ("PANGO_MODULE_VERSION", "1.6.0", TRUE);
+  g_setenv ("PANGO_SO_EXTENSION", ".dll", TRUE);
+  g_print ("Setting PANGO_PREFIX=%s\n", prefix);
+  g_setenv ("GTK_PREFIX", prefix, TRUE);
+  g_print ("Setting GTK_PREFIX=%s\n", prefix);
+  g_setenv ("GTK_MODULE_VERSION", "2.10.0", TRUE);
+  g_setenv ("GTK_SO_EXTENSION", ".dll", TRUE);
 #endif
   /* locale initialization */
   //setlocale (LC_CTYPE, "");

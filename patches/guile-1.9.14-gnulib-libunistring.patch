--- guile-1.9.14/m4/libunistring.m4~	2010-12-14 19:15:17.000000000 +0100
+++ guile-1.9.14/m4/libunistring.m4	2011-02-02 02:09:21.822354542 +0100
@@ -72,9 +72,7 @@ AC_DEFUN([gl_LIBUNISTRING_CORE],
     dnl First, try to link without -liconv. libunistring often depends on
     dnl libiconv, but we don't know (and often don't need to know) where
     dnl libiconv is installed.
-    AC_LIB_HAVE_LINKFLAGS([unistring], [],
-      [#include <uniconv.h>], [u8_strconv_from_locale((char*)0);],
-      [no, trying again together with libiconv])
+    AC_CHECK_LIB(unistring, [u8_strconv_from_locale], [HAVE_LIBUNISTRING=yes ac_cv_libunistring=yes AC_SUBST(HAVE_LIBUNISTRING) LTLIBUNISTRING="-lunistring" AC_SUBST(LTLIBUNISTRING)])
     if test "$ac_cv_libunistring" != yes; then
       dnl Second try, with -liconv.
       dnl We have to erase the cached result of the first AC_LIB_HAVE_LINKFLAGS
@@ -80,9 +80,7 @@ AC_DEFUN([gl_LIBUNISTRING_CORE],
       unset ac_cv_libunistring
       glus_save_LIBS="$LIBS"
       LIBS="$LIBS $LIBICONV"
-      AC_LIB_HAVE_LINKFLAGS([unistring], [],
-        [#include <uniconv.h>], [u8_strconv_from_locale((char*)0);],
-        [no, consider installing GNU libunistring])
+    AC_CHECK_LIB(unistring, [u8_strconv_from_locale], [HAVE_LIBUNISTRING=yes ac_cv_libunistring=yes AC_SUBST(HAVE_LIBUNISTRING) LTLIBUNISTRING="-lunistring" AC_SUBST(LTLIBUNISTRING)])
       if test -n "$LIBUNISTRING"; then
         LIBUNISTRING="$LIBUNISTRING $LIBICONV"
         LTLIBUNISTRING="$LTLIBUNISTRING $LTLIBICONV"
@@ -90,9 +90,7 @@ AC_DEFUN([gl_LIBUNISTRING_CORE],
       LIBS="$glus_save_LIBS"
     fi
   else
-    AC_LIB_HAVE_LINKFLAGS([unistring], [],
-      [#include <uniconv.h>], [u8_strconv_from_locale((char*)0);],
-      [no, consider installing GNU libunistring])
+    AC_CHECK_LIB(unistring, [u8_strconv_from_locale], [HAVE_LIBUNISTRING=yes ac_cv_libunistring=yes AC_SUBST(HAVE_LIBUNISTRING) LTLIBUNISTRING="-lunistring" AC_SUBST(LTLIBUNISTRING)])
   fi
   if test $HAVE_LIBUNISTRING = yes; then
     dnl Determine the installed version.

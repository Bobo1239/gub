# -*-shell-script-*-

[Meta]
SoftwareVersion: @VERSION@
RootName: @lilypond.org/lilypond:$SOFTWAREVERSION
DisplayName: LilyPond
DisplayName[nl]: LilyPond
ShortName: lilypond
Maintainer: LilyPond Development team - http://lilypond.org
Packager: Jan Nieuwenhuizen <janneke@gnu.org>
Summary: Create and print beautiful music notation 
Summary[nl]: Maak en druk prachtige bladmuziek
PackageVersion: 0
InterfaceVersion: 0
AutopackageTarget: 1.0

[Description]
LilyPond lets you create music notation.  It produces
beautiful sheet music from a high-level description file.

[BuildPrepare]
export PREFIX=/usr
tar -cf- --exclude autopackage . | tar -C $build_root -xvf-

[BuildUnprepare]
unprepareBuild

[Imports]

# Remove symlinks that confuse copyFiles
rm share/lilypond/@VERSION@/dvips/ps
rm share/lilypond/@VERSION@/dvips/map

rm bin/fonts.cache-1


echo '*' | import


[Prepare]
echo Prepare

[Install]
 #[ "$PREFIX" == "/usr" ] && export PREFIX=/opt/autopackage
mkdirs "$PREFIX/bin"
# Not using installExe, it generates a useless wrapper.
# installExe bin/*
copyFiles bin/.* "$PREFIX/bin"
chmod +x "$PREFIX/bin"
installExe bin/*

mkdirs "$PREFIX/share/lilypond/@VERSION@/"
copyFiles "share/lilypond/@VERSION@/"/* "$PREFIX/share/lilypond/@VERSION@/"

mkdirs "$PREFIX/lib/lilypond/@VERSION@/dvips"
(cd "$PREFIX/share/lilypond/@VERSION@/dvips"; ln -fs ../fonts/map .)
(cd "$PREFIX/share/lilypond/@VERSION@/dvips"; ln -fs ../ps .)

mkdirs "$PREFIX/lib/lilypond/@VERSION@"
copyFiles "lib/lilypond/@VERSION@"/* "$PREFIX/lib/lilypond/@VERSION@/"

mkdirs "$PREFIX/lib/lilypond/framework/"
copyFiles "lib/lilypond/framework"/* "$PREFIX/lib/lilypond/framework/"

[Uninstall]
uninstallFromLog
